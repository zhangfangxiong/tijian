<?phpclass Controller_Admin_Base extends Yaf_Controller{    /**     * 是否进行登录检测     *      * @var unknown     */    protected $bCheckLogin = true;    /**     * 当前用户     *      * @var unknown     */    protected $aCurrUser = null;    /**     * 当前城市     *      * @var unknown     */    protected $iCurrCityID = null;    protected $aCurrCity = null;    /**     * 执行Action前执行     *      * @see Yaf_Controller::actionBefore()     */    public function actionBefore ()    {        $this->_frame = 'admin.phtml';        if ($this->bCheckLogin) {            // 当前用户            $aCookie = Util_Cookie::get(Yaf_G::getConf('authkey', 'cookie'));            if (empty($aCookie)) {                return $this->redirect('/admin/login');            }            $this->aCurrUser = $aCookie;            // 当前城市            $this->iCurrCityID = Util_Cookie::get('city');            if (empty($this->iCurrCityID)) {                $this->iCurrCityID = $this->aCurrUser['iCityID'];            }            $this->aCurrCity = Model_City::getDetail($this->iCurrCityID);        }                $this->assign('sStaticRoot', 'http://' . Yaf_G::getConf('static', 'domain'));    }    /**     * 执行Action后的操作     *      * @see Yaf_Controller::actionAfter()     */    public function actionAfter ()    {        if ($this->autoRender() == true) {            if (! empty($this->aCurrUser)) {                $this->assign('aCurrUser', $this->aCurrUser);                                // 菜单列表                $aMenuTree = Model_Menu::getTree($this->aCurrUser['iUserID']);                $this->assign('__aMenuTree__', $aMenuTree);                $this->assign('iCurrCityID', $this->iCurrCityID);                $this->assign('aCurrCity', $this->aCurrCity);                                // 城市列表                $this->assign('__aCityList__', Model_City::getPairCitys());                                // Request对象                $this->assign('oRequest', $this->_request);            }                        $aDebug = Util_Common::getDebugData();            if ($aDebug) {                $this->assign('__showDebugInfo__', 'showDebugInfo(' . json_encode($aDebug) . ');');            }        } else {}    }    /**     * 取得是否要检查登录权限     *      * @return boolean     */    public function getCheckLogin ()    {        return $this->bCheckLogin;    }}